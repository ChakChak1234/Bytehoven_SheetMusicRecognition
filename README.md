# Bytehoven - Sheet music recognition with ResNet50

![Byethoven](images/Bytehoven.jpeg)

This repository contains the resources used in the development of Bytehoven, a deep learning sheet music recognition model currently in development. [Please find the full tutorial here.](http://www.paulvangent.com/2017/12/07/deep-learning-music/) The current version recognises piano music from Bach, Beethoven, Brahms, Chopin, Grieg, Liszt, and Mozart.

Trained model weights are available under 'releases'. We'll keep training on more data and composers to increase Bytehoven's knowledge base.

Index:
<index>


# Dataset organisation and methods
Source material has been downloaded from the [Petrucci Music Library](http://imslp.org). Datasets have been generated by downloading all piano works from each composer, 
and splitting each piece into images of individual rows of music. For de Dev and Test set, full compositions were taken out of the training set (to prevent the net from
recognising thematic works or repeated phrases).


The net was trained for 100 epochs, starting with learning rate 0.001 which decayed linearly to 0 over epochs.


# Current Results
The current released model version scores 76.44% validation accuracy on the test set (98.23% train set, 73.41% dev set).

When evaluating difficult to classify composers, an interesting pattern arose with Rubinstein. Anton Rubinstein is often confused with Tchaikovsky and Rachmaninov:

![Rubinstein](images/33cat/hard_composers/Rubinstein.jpg)

This is especially interesting, since Rubinstein [was Tchaikovsky's composition teacher](https://en.wikipedia.org/wiki/Pyotr_Ilyich_Tchaikovsky#Civil_service;_pursuing_music), and Rachmaninov's [early compositional influence](https://en.wikipedia.org/wiki/Sergei_Rachmaninoff#Compositional_style) was Tchaikovsky, and who also expressed having Rubinstein as a role model.



# Included files

- datasets/Musicdata_Small.rar -- Dataset of small sized images (200*35px)
- datasets/Musicdata_Medium.rar -- Dataset of medium sized images (400*70px)
- resnet50.py -- ResNet50 architecture implemented in Keras
- run_resnet50.py -- Example to initiate training run

Releases:
- Release V0.1: bytehoven-7-weights.hdf5 -- Model weights trained on medium sized set with 7 composers (full training log included), reaching 99.5% validation accuracy on test set.
- Release V0.2: bytehoven-22-weights.hdf5 -- Model weights trained on 22 composers (training log and composer list included).




# Network activation and filter visualisation

Final network layer activation for two random pieces:


Beethoven:
![Beethoven](images/Beethoven_Visualisation.jpg)


Chopin:
![Chopin](images/Chopin_Visualisation.jpg)


Random filters visualised (filters lower in the image are deeper in the network):
![Filters](images/Filters.jpg)